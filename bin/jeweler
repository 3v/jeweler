#!/usr/bin/env ruby
require 'rubygems'
require 'optparse'

$:.unshift File.join(File.dirname(__FILE__), '..', 'lib')
require 'jeweler'

class JewelerOpts < Hash
  attr_reader :opts
  
  def initialize(args)
    super()
    
    self[:test_style] = :shoulda
    
    @opts = OptionParser.new do |o|
      o.banner = "Usage: #{File.basename($0)} [options] reponame\ne.g. #{File.basename($0)} the-perfect-gem"
      
      o.on('--bacon', 'generate bacon specs') do
        self[:test_style] = :bacon
      end
      
      o.on('--shoulda', 'generate shoulda tests') do
        self[:test_style] = :shoulda
      end
      
      o.on_tail('-h', '--help', 'display this help and exit') do
        puts o
        exit
      end
    end
    
    @opts.parse!(args)
  end
end

options = JewelerOpts.new(ARGV)

unless ARGV.size == 1
  puts options.opts
  exit 1
end

github_repo_name = ARGV.first
generator = Jeweler::Generator.new github_repo_name, options
generator.run
