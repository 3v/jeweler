<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html;charset=utf-8" />

		<link rel="stylesheet" href="css/screen.css" type="text/css" media="screen, projection" />
		<link rel="stylesheet" href="css/print.css" type="text/css" media="print" /> 

		<!--[if IE]>
		<link rel="stylesheet" href="css/ie.css" type="text/css" media="screen, projection" />
		<![endif]-->

		<link rel="stylesheet" href="css/style.css" type="text/css" media="screen, projection" />

	</head>
	<body>
		<div class="container">
			<div class="span-18">
				<h1>Jeweler: Let us craft you the perfect gem</h1>

				<p>Rubygems are the awesome way of distributing your code to others. GitHub is the awesome way of managing the source code of your project. GitHub can even generate a Rubygem if you include a gemspec.</p>

				<p>Trouble is when developing your Rubygems on GitHub, you generally do one of the following:</p>

				<ul>
					<li>
						<p>Manage the gemspec by hand * … why bother doing something by hand when you can automate it?</p>
					</li>

					<li>
						<p>Write your own Rake stuff to create the Gem::Specification and output it to a gemspec file, and deal with keeping the Rakefile and gemspec in sync * … why keep reinventing the wheel?</p>
					</li>

					<li>
						<p>Use hoe or echoe for generating the gemspec</p>

						<ul>
							<li>… why use utilities made for the days before GitHub existed?</li>

							<li>… why have extra stuff you aren’t going to use?</li>
						</ul>
					</li>
				</ul>

				<p>Jeweler was created with a few goals in mind:</p>

				<ul>
					<li>Only use a Gem::Specification as configuration</li>

					<li>Be one command away from version bumping and releasing</li>

					<li>Store version information in one place</li>

					<li>Only concern itself with git, gems, and versioning</li>

					<li>Not be a requirement for using your Rakefile (you just wouldn’t be able to use its tasks)</li>

					<li>Use Jeweler internally. Oh the meta!</li>
				</ul>

				<h2>Installation</h2>

				<p>Run the following if you haven’t already:</p>

<pre><code>gem sources -a http://gems.github.com</code></pre>

				<p>Install the gem:</p>

<pre><code>sudo gem install technicalpickles-jeweler</code></pre>

				<h2>Configuration for an existing project</h2>

				<p>Armed with the gem, we can begin diving into an example. <a href="http://github.com/technicalpickles/the-perfect-gem/tree">the-perfect-gem</a> was setup as a Jeweler showcase, and a simple example:</p>

<pre><code>begin
  require 'jeweler'
  Jeweler::Tasks.new do |s|
    s.name = "the-perfect-gem"
    s.summary = "TODO"
    s.email = "josh@technicalpickles.com"
    s.homepage = "http://github.com/technicalpickles/the-perfect-gem"
    s.description = "TODO"
    s.authors = ["Josh Nichols"]
  end
rescue LoadError
  puts "Jeweler not available. Install it with: sudo gem install technicalpickles-jeweler -s http://gems.github.com"
end</code></pre>

				<p>Here’s a rundown of what’s happening:</p>

				<ul>
					<li>
						<p>Wrap everything in a begin block, and rescue from LoadError * This lets us degrade gracefully if jeweler isn’t installed</p>
					</li>

					<li>
						<p>Make a new <code>Jeweler::Tasks</code></p>

						<ul>
							<li>
								<p>It gets yielded a new <code>Gem::Specification</code></p>
							</li>

							<li>
								<p>This is where all the configuration happens</p>
							</li>

							<li>
								<p>Things you definitely need to specify: * <code>name</code></p>
							</li>

							<li>
								<p>Things you probably want to specify:</p>

								<ul>
									<li><code>summary</code></li>

									<li><code>email</code></li>

									<li><code>homepage</code></li>

									<li><code>description</code></li>

									<li><code>authors</code></li>
								</ul>
							</li>

							<li>
								<p>Things you can specify, but have defaults * <code>files</code>, defaults to <code>FileList["[A-Z]*.*", "{bin,generators,lib,test,spec}/**/*"]</code></p>
							</li>

							<li>
								<p>Things you shouldn’t specify: * <code>version</code>, because Jeweler takes care of this for you</p>
							</li>

							<li>
								<p>Other things of interest</p>

								<ul>
									<li><code>executables</code>, if you have any scripts</li>

									<li><code>add_dependency</code>, if you have any dependencies</li>
								</ul>
							</li>

							<li>
								<p>Keep in mind that this is a <code>Gem::Specification</code>, so you can do whatever you would need to do to get your gem in shape</p>
							</li>
						</ul>
					</li>
				</ul>

				<h2>Bootstrap a new project</h2>

				<p>Before proceeding, take a minute to setup your git environment, specifically your name, email address, and GitHub username</p>

<pre><code>$ git config --global user.email johndoe@example.com
$ git config --global user.name 'John Doe'
$ git config --global github.user johndoe
$ git config --global github.token 55555555555555</code></pre>

				<p>Jeweler provides a generator of sorts, <code>jeweler</code>. It requires only argument, the name of a repo you want to create. It also takes a few options: –<a href="http://github.com/thoughtbot/shoulda">shoulda</a> and –<a href="http://github.com/chneukirchen/bacon/tree/master">bacon</a>. These control what type of tests are created, with the default being shoulda.</p>

<pre><code>$ jeweler --create-repo the-perfect-gem</code></pre>

				<p>Basically, this does:</p>

				<ul>
					<li>
						<p>Creates the the-perfect-gem directory</p>
					</li>

					<li>
						<p>Seeds it with some basic files:</p>

						<ul>
							<li><code>.gitignore</code>, with the usual suspects predefined</li>

							<li><code>Rakefile</code>, setup with tasks for jeweler, test, rdoc, and rcov</li>

							<li><code>README</code>, with your project name</li>

							<li><code>LICENSE</code>, MIT, with your name prefilled</li>

							<li><code>test/test_helper</code>, setup with shoulda, mocha, and a re-opened <code>Test::Unit::TestCase</code></li>

							<li><code>test/the_perfect_gem.rb</code>, placeholder failing test</li>

							<li><code>lib/the_perfect_gem.rb</code>, placeholder library file</li>
						</ul>
					</li>

					<li>
						<p>Makes it a git repo</p>
					</li>

					<li>
						<p>Sets up <code>git@github.com:johndoe/jeweler.git</code> as the <code>origin</code> git remote</p>
					</li>

					<li>
						<p>Makes an initial commit</p>
					</li>

					<li>
						<p>Sets up a new repository on GitHub and pushes to it (omit –create-repo to skip this)</p>
					</li>
				</ul>

				<p>You also probably should <a href="http://github.com/blog/51-github-s-rubygem-server">enable RubyGem creation for you repository</a>: Go to your project’s edit page and check the ‘RubyGem’ box.</p>

				<h2>Overview of Jeweler workflow</h2>

				<p>Here’s the general idea:</p>

				<ul>
					<li>Hack, commit, hack, commit, etc, etc</li>

					<li>Version bump</li>

					<li>Release</li>

					<li>Have a delicious scotch</li>
				</ul>

				<p>The hacking and the scotch are up to you, but Jeweler provides rake tasks for the rest.</p>

				<h3>Versioning</h3>

				<p>Versioning information is stored in <code>VERSION.yml</code>. It’s a plain ol’ YAML file which contains three things:</p>

				<ul>
					<li>major</li>

					<li>minor</li>

					<li>patch</li>
				</ul>

				<p>Consider, for a second, <code>1.5.3</code>.</p>

				<ul>
					<li>major = 1</li>

					<li>minor = 5</li>

					<li>patch = 3</li>
				</ul>

				<h4>Your first time</h4>

				<p>When you first start using Jeweler, there won’t be a <code>VERSION.yml</code>, so it’ll assume 0.0.0.</p>

				<p>If you need some arbitrary version, you can do one of the following:</p>

				<ul>
					<li><code>rake version:write MAJOR=6 MINOR=0 PATCH=3</code></li>

					<li>Write <code>VERSION.yml</code> by hand (lame)</li>
				</ul>

				<h4>After that</h4>

				<p>You have a few rake tasks for doing the version bump:</p>

<pre><code>$ rake version:bump:patch # 1.5.1 -&gt; 1.5.2
$ rake version:bump:minor # 1.5.1 -&gt; 1.6.0
$ rake version:bump:major # 1.5.1 -&gt; 2.0.0</code></pre>

				<p>If you need to do an arbitrary bump, use the same task you used to create <code>VERSION.yml</code>:</p>

<pre><code>$ rake version:write MAJOR=6 MINOR=0 PATCH=3</code></pre>

				<p>The process of version bumping does a commit to your repo, so make sure your repo is in a clean state (ie nothing uncommitted).</p>

				<h3>Release it</h3>

				<p>It’s pretty straight forward:</p>

<pre><code>$ rake release</code></pre>

				<p>This takes care of:</p>

				<ul>
					<li>Generating a <code>.gemspec</code> for you project, with the version you just bumped to</li>

					<li>Commit and push the updated <code>.gemspec</code></li>

					<li>Create a tag</li>

					<li>Push the tag</li>
				</ul>

				<h3>Play the waiting game</h3>

				<p>How do you know when your gem is built? <a href="http://hasmygembuiltyet.org/">Has My Gem Built Yet</a> was specifically designed to answer that question.</p>

				<p>If it happens to be down, you can also check out the GitHub Gem repo’s <a href="http://gems.github.com/list">list</a>. Just search for youname-yourrepo.s</p>

				<h3>Putting it all together</h3>

<pre><code>&lt;hack, hack, hack, commit&gt;
$ rake version:bump:patch release</code></pre>

				<p>Now browse to http://gems.github.com/yourname/yourproject, and wait for it to be built.</p>

			</div>
			<div class="span-6 last">
				<ul>
					<li>Version 0.6.2</li>
					<li><a href="http://github.com/technicalpickles/jeweler">Source Code</a></li>
					<li><a href="rdoc">Documentation</a></li>
				</ul>
			</div>
		</div>
	</body>
</html>
